<?xml version="1.0" encoding="iso-8859-1"?>

<Database>
   <Name>script</Name>
   <Table>
      <Name>users</Name>
      <Column>
         <Name>id</Name>
         <Type>VARCHAR(36) </Type>
      </Column>
      <Column>
         <Name>email</Name>
         <Type>VARCHAR(255) </Type>
         <Property>NOT NULL</Property>
      </Column>
      <Column>
         <Name>password_hash</Name>
         <Type>VARCHAR(255) </Type>
         <Property>NOT NULL</Property>
      </Column>
      <Column>
         <Name>full_name</Name>
         <Type>VARCHAR(255) </Type>
      </Column>
      <Column>
         <Name>phone</Name>
         <Type>VARCHAR(20) </Type>
      </Column>
      <Column>
         <Name>is_active</Name>
         <Type>BOOLEAN</Type>
         <Property>DEFAULT TRUE</Property>
      </Column>
      <Column>
         <Name>is_locked</Name>
         <Type>BOOLEAN</Type>
         <Property>DEFAULT FALSE</Property>
      </Column>
      <Column>
         <Name>failed_login_attempts</Name>
         <Type>REAL</Type>
         <Property>DEFAULT 0</Property>
      </Column>
      <Column>
         <Name>last_failed_login</Name>
         <Type>TIMESTAMP</Type>
      </Column>
      <Column>
         <Name>last_login</Name>
         <Type>TIMESTAMP</Type>
      </Column>
      <Column>
         <Name>created_at</Name>
         <Type>TIMESTAMP</Type>
         <Property>DEFAULT CURRENT_TIMESTAMP</Property>
      </Column>
      <Column>
         <Name>updated_at</Name>
         <Type>TIMESTAMP</Type>
         <Property>DEFAULT CURRENT_TIMESTAMP</Property>
      </Column>
      <Column>
         <Name>firestore_id</Name>
         <Type>VARCHAR(255) </Type>
         <Property>UNIQUE</Property>
      </Column>
      <Column>
         <Name>sync_status</Name>
         <Type>VARCHAR(20) </Type>
         <Property>DEFAULT 'PENDING' CHECK (sync_status IN ('PENDING', 'SYNCED', 'FAILED'))</Property>
      </Column>
      <PK>
         <Key>id</Key>
      </PK>
      <AK>
         <Key>firestore_id</Key>
      </AK>
   </Table>
   <Table>
      <Name>user_sessions</Name>
      <Column>
         <Name>id</Name>
         <Type>VARCHAR(36) </Type>
      </Column>
      <Column>
         <Name>session_token</Name>
         <Type>VARCHAR(512) </Type>
         <Property>NOT NULL UNIQUE</Property>
      </Column>
      <Column>
         <Name>refresh_token</Name>
         <Type>VARCHAR(512) </Type>
         <Property>UNIQUE</Property>
      </Column>
      <Column>
         <Name>device_info</Name>
         <Type>TEXT</Type>
      </Column>
      <Column>
         <Name>ip_address</Name>
         <Type>VARCHAR(45) </Type>
      </Column>
      <Column>
         <Name>expires_at</Name>
         <Type>TIMESTAMP</Type>
         <Property>NOT NULL</Property>
      </Column>
      <Column>
         <Name>created_at</Name>
         <Type>TIMESTAMP</Type>
         <Property>DEFAULT CURRENT_TIMESTAMP</Property>
      </Column>
      <Column>
         <Name>is_valid</Name>
         <Type>BOOLEAN</Type>
         <Property>DEFAULT true</Property>
      </Column>
      <Column>
         <Name>firestore_id</Name>
         <Type>VARCHAR(255) </Type>
         <Property>UNIQUE</Property>
      </Column>
      <Column>
         <Name>sync_status</Name>
         <Type>VARCHAR(20) </Type>
         <Property>DEFAULT 'PENDING' CHECK (sync_status IN ('PENDING', 'SYNCED', 'FAILED'))</Property>
      </Column>
      <Column>
         <Name>id_1</Name>
         <Type>VARCHAR(36) </Type>
         <Property>NOT NULL</Property>
      </Column>
      <PK>
         <Key>id</Key>
      </PK>
      <AK>
         <Key>session_token</Key>
      </AK>
      <AK>
         <Key>refresh_token</Key>
      </AK>
      <AK>
         <Key>firestore_id</Key>
      </AK>
      <FK>
         <Key>id_1</Key>
         <Reference>users(id)</Reference>
      </FK>
   </Table>
   <Table>
      <Name>security_settings</Name>
      <Column>
         <Name>id</Name>
         <Type>SERIAL</Type>
      </Column>
      <Column>
         <Name>setting_key</Name>
         <Type>VARCHAR(100) </Type>
         <Property>NOT NULL</Property>
      </Column>
      <Column>
         <Name>setting_value</Name>
         <Type>TEXT</Type>
         <Property>NOT NULL</Property>
      </Column>
      <Column>
         <Name>description</Name>
         <Type>TEXT</Type>
      </Column>
      <Column>
         <Name>updated_at</Name>
         <Type>TIMESTAMP</Type>
         <Property>DEFAULT CURRENT_TIMESTAMP</Property>
      </Column>
      <PK>
         <Key>id</Key>
      </PK>
   </Table>
</Database>
