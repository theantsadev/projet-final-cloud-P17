#!/bin/bash
# test_all_swagger_endpoints.sh

echo "=== TEST DE TOUS LES ENDPOINTS DOCUMENT√âS DANS SWAGGER ==="
echo ""

BASE_URL="http://localhost:8080"

# 1. AUTH - REGISTER (Firebase)
echo "1. üîê POST /api/auth/register (Firebase):"
curl -s -X POST "http://localhost:8080/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{"email":"dom@test.com","password":"dom123","fullName":"Swagger User"}'

echo -e "\n"

# 2. AUTH - LOGIN
echo "2. üîê POST /api/auth/login:"
curl -s -X POST "http://localhost:8080/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"email":"swagger@test.com","password":"Swagger123"}'

echo -e "\n"

# 3. AUTH - CHECK LOCK
echo "3. üîê GET /api/auth/check-lock/{email}:"
curl -s "$BASE_URL/api/auth/check-lock/swagger@test.com"

echo -e "\n"

# 4. USERS - GET BY ID (supposons ID=4)
echo "4. üë§ GET /api/users/{id}:"
curl -s "$BASE_URL/api/users/4"

echo -e "\n"

# 5. USERS - UPDATE
echo "5. üë§ PUT /api/users/{id}:"
curl -s -X PUT "$BASE_URL/api/users/4" \
  -H "Content-Type: application/json" \
  -d '{"email":"updated.swagger@test.com","fullName":"Updated Swagger"}'

echo -e "\n"

# 6. USERS - UNBLOCK
echo "6. üë§ POST /api/users/unblock/{email}:"
curl -s -X POST "$BASE_URL/api/users/unblock/swagger@test.com"

echo -e "\n"

# 7. USERS - BLOCK
echo "7. üë§ POST /api/users/block/{email}:"
curl -s -X POST "$BASE_URL/api/users/block/swagger@test.com"

echo -e "\n"

# 8. CONFIG - GET SESSION
echo "8. ‚öôÔ∏è GET /api/config/session:"
curl -s "$BASE_URL/api/config/session"

echo -e "\n"

# 9. CONFIG - GET TIMEOUT
echo "9. ‚öôÔ∏è GET /api/config/session/timeout:"
curl -s "$BASE_URL/api/config/session/timeout"

echo -e "\n"

# 10. CONFIG - GET ATTEMPTS
echo "10. ‚öôÔ∏è GET /api/config/session/attempts:"
curl -s "$BASE_URL/api/config/session/attempts"

echo -e "\n"

# 11. CONFIG - UPDATE TIMEOUT
echo "11. ‚öôÔ∏è PUT /api/config/session/timeout:"
curl -s -X PUT "$BASE_URL/api/config/session/timeout?minutes=120"

echo -e "\n"

# 12. CONFIG - UPDATE ATTEMPTS
echo "12. ‚öôÔ∏è PUT /api/config/session/attempts:"
curl -s -X PUT "$BASE_URL/api/config/session/attempts?attempts=8"

echo -e "\n"

echo "=== V√âRIFICATION FINALE ==="
curl -s "$BASE_URL/api/config/session"

echo -e "\n\n=== SWAGGER UI ==="
echo "Acc√©dez √† la documentation compl√®te:"
echo "üìö Swagger UI: $BASE_URL/swagger-ui.html"
echo "üìÑ OpenAPI JSON: $BASE_URL/api-docs"